

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Automatic Deployment &mdash; Rain 0.18.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.18.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Rain 0.18.0 documentation" href="../index.html" />
    <link rel="next" title="Elastic architecture" href="Features-proposal-elastic-architecture.html" />
    <link rel="prev" title="Dashboard Component Model" href="Features-proposal-dashboard-component-model.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="Features-proposal-elastic-architecture.html" title="Elastic architecture"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Features-proposal-dashboard-component-model.html" title="Dashboard Component Model"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Rain 0.18.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="automatic-deployment">
<h1>Automatic Deployment<a class="headerlink" href="#automatic-deployment" title="Permalink to this headline">¶</a></h1>
<p>Whenever a new release is ready it should be deployed so that the interested persons are able to
access the application. Right now, the deployment is a manual, error prone process. This proposal
shows how this process can be automated. The deployment process must easily support rollback to
previous versions if something goes wrong.</p>
<div class="section" id="why-git">
<h2>Why Git?<a class="headerlink" href="#why-git" title="Permalink to this headline">¶</a></h2>
<p>Git is an open source distributed version control system designed to handle everything from small to
very large projects with speed and efficiency. The data model that Git uses ensures the cryptographic
integrity of every bit of your project. Every file and commit is checksummed and retrieved by its
checksum when checked back out.</p>
<p>In the deployment process, Git will be used as a transport for the files that needs to be deployed.
The main advantages of using Git instead of simply copying the files are:</p>
<ul class="simple">
<li>faster deployment, only the changes since the last release are transfered</li>
<li>it ensures the integrity of the deployment</li>
<li>the ability to track what was deployed and when. Having this information allows the rollback to a
previous version by simply retrieving the tag associated with the release.</li>
</ul>
<p>Git needs to be installed on each machine that will be used to deploy the application. Two
repositories will be created: a bare repository that will act as a server (new releases will be
pushed to this repository) and a normal repository that will contain the working copy.</p>
</div>
<div class="section" id="deployment-flow">
<h2>Deployment Flow<a class="headerlink" href="#deployment-flow" title="Permalink to this headline">¶</a></h2>
<p>A deploy is triggered by executing the RAIN SDK <tt class="docutils literal"><span class="pre">deploy</span></tt> command for the project to be deployed.
The deployment configurations will be located in the <em>package.json</em> file:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="c1">// ...</span>
<span class="s2">&quot;deployment&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;server1&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;user@server1:/path/to/repo&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;server2&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;user@server2:/path/to/repo&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The server on which to deploy is specified by passing the configuration key as a command line
argument to the deploy command:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="nx">rain</span> <span class="nx">deploy</span> <span class="nx">server1</span>
</pre></div>
</div>
<p>When executed, this command will push the changes from the local repository to the repository
specified in the configuration (this is the bare repository located on the server).</p>
<p>The bare repository has a <tt class="docutils literal"><span class="pre">post-receive</span></tt> hook which is run after the push process finished and
executes the following operations:</p>
<ol class="arabic simple">
<li>updates the files in the normal repository by pulling from the bare repository</li>
<li>creates a tag on the last commit to mark the point in history corresponding to the current
deploy</li>
<li>runs a build script located in the project directory (this will be used to add actions like
building the documentation, running the unit tests etc.)</li>
<li>starts the RAIN server</li>
<li>if one of the last two steps fails, reverts the state of the working copy to the last successful
deploy (this is done by reverting to the most recent tag that was deployed without errors) and
marks the tag associated with the current deploy as a failure.</li>
</ol>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Automatic Deployment</a><ul>
<li><a class="reference internal" href="#why-git">Why Git?</a></li>
<li><a class="reference internal" href="#deployment-flow">Deployment Flow</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="Features-proposal-dashboard-component-model.html"
                        title="previous chapter">Dashboard Component Model</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Features-proposal-elastic-architecture.html"
                        title="next chapter">Elastic architecture</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="Features-proposal-elastic-architecture.html" title="Elastic architecture"
             >next</a> |</li>
        <li class="right" >
          <a href="Features-proposal-dashboard-component-model.html" title="Dashboard Component Model"
             >previous</a> |</li>
        <li><a href="../index.html">Rain 0.18.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>